var Duration=function(a){this.seconds=0;if("undefined"==a||void 0==a||""==a)a=0;if("number"===typeof a&&0>a)throw Error(Duration.prototype.Error.NegativeValue);if("number"===typeof a)this.seconds=a;else{var e=!1,c;for(c in Duration.prototype.DurationFormat){var d=Duration.prototype.DurationFormat[c].pattern,b=Duration.prototype.DurationFormat[c].parser;if(d.test(a)){e=!0;this.seconds=b(this.seconds,a.match(d));break}}if(!e)throw Error(Duration.prototype.Error.UnexpectedFormat);}if(isNaN(this.seconds))throw Error(Duration.prototype.Error.Overflow);
};Duration.prototype.Calendar={Seconds:{per:{Minute:60,Hour:3600,Day:86400,Week:604800,Month:2629739.52,Year:3.15569088E7}},Minutes:{per:{Hour:60,Day:1440,Week:10080,Month:1440*30.4368,Year:525948.48}},Hours:{per:{Day:24,Week:168,Month:730.4832,Year:8765.808}},Days:{per:{Week:7,Month:30.4368,Year:365.242}},Weeks:{per:{Month:4.34812,Year:52.1775}},Months:{per:{Year:12}}};Duration.prototype.Error={};Duration.prototype.Error.UnexpectedFormat="Unexpected duration format. Refer to ISO 8601.";
Duration.prototype.Error.NegativeValue="Cannot create a negative duration.";Duration.prototype.Error.Overflow="Cannot represent a duration that large. Float overflow.";Duration.prototype.Parser={};
Duration.prototype.Parser.Extended=function(a,e){for(var c=Duration.prototype.Calendar,d=1;d<e.length;d++){var b=parseInt(e[d],10);if(1===d)a+=b*c.Seconds.per.Year;else if(2===d){if(12<=b)throw Error(Duration.prototype.Error.UnexpectedFormat);a+=b*c.Seconds.per.Month}else if(3===d){if(31<b)throw Error(Duration.prototype.Error.UnexpectedFormat);a+=b*c.Seconds.per.Day}else if(4===d){if(24<=b)throw Error(Duration.prototype.Error.UnexpectedFormat);a+=b*c.Seconds.per.Hour}else if(5===d){if(60<=b)throw Error(Duration.prototype.Error.UnexpectedFormat);
a+=b*c.Seconds.per.Minute}else if(6===d){if(60<=b)throw Error(Duration.prototype.Error.UnexpectedFormat);a+=b}}return a};Duration.prototype.Parser.Basic=Duration.prototype.Parser.Extended;Duration.prototype.Parser.StandardWeeks=function(a,e){for(var c=Duration.prototype.Calendar,d=1;d<e.length;d++){var b=e[d];if(/\d+W/.test(b))a+=parseInt(b.replace("W",""),10)*c.Seconds.per.Week;else if(/\d+[A-Z]/.test(b))throw Error(Duration.prototype.Error.UnexpectedFormat);}return a};
Duration.prototype.Parser.Standard=function(a,e){var c=Duration.prototype.Calendar;if("P"===e[0]||"PT"===e[0])throw Error(Duration.prototype.Error.UnexpectedFormat);for(var d=!1,b=1;b<e.length;b++){var f=e[b];if(/T/.test(f))d=!0;else if(/\d+Y/.test(f))a+=parseInt(f.replace("Y",""),10)*c.Seconds.per.Year;else if(/\d+M/.test(f)&&!d)a+=parseInt(f.replace("M",""),10)*c.Seconds.per.Month;else if(/\d+D/.test(f))a+=parseInt(f.replace("D",""),10)*c.Seconds.per.Day;else if(/\d+H/.test(f))a+=parseInt(f.replace("H",
""),10)*c.Seconds.per.Hour;else if(/\d+M/.test(f)&&d)a+=parseInt(f.replace("M",""),10)*c.Seconds.per.Minute;else if(/\d+S/.test(f))a+=parseInt(f.replace("S",""),10);else if(/\d+[A-Z]/.test(f))throw Error(Duration.prototype.Error.UnexpectedFormat);}return a};
Duration.prototype.DurationFormat={Extended:{pattern:/^P(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})$/,parser:Duration.prototype.Parser.Extended},Basic:{pattern:/^P(\d{4})(\d{2})(\d{2})T(\d{2})(\d{2})(\d{2})$/,parser:Duration.prototype.Parser.Basic},StandardWeeks:{pattern:/^P(\d+W)$/,parser:Duration.prototype.Parser.StandardWeeks},Standard:{pattern:/^P(\d+Y)*(\d+M)*(\d+D)*(?:(T)(\d+H)*(\d+M)*(\d+S)*)?$/,parser:Duration.prototype.Parser.Standard}};
Duration.prototype.padInt=function(a,e){a+="";for(var c="",d=0,b=0;b<e;b++)c=e-b<=a.length?c+a[d++]:c+"0";return c};Duration.prototype.inSeconds=function(){return this.seconds};Duration.prototype.inMinutes=function(){return this.seconds/this.Calendar.Seconds.per.Minute};Duration.prototype.inHours=function(){return this.seconds/this.Calendar.Seconds.per.Hour};Duration.prototype.inDays=function(){return this.seconds/this.Calendar.Seconds.per.Day};
Duration.prototype.inWeeks=function(){return this.seconds/this.Calendar.Seconds.per.Week};Duration.prototype.inMonths=function(){return this.seconds/this.Calendar.Seconds.per.Month};Duration.prototype.inYears=function(){return this.seconds/this.Calendar.Seconds.per.Year};Duration.prototype.add=function(a){return new Duration(this.seconds+a.seconds)};Duration.prototype.subtract=function(a){return new Duration(this.seconds-a.seconds)};
Duration.prototype.value=function(){var a={};a.years=Math.floor(this.seconds/this.Calendar.Seconds.per.Year);a.months=Math.floor((this.seconds-a.years*this.Calendar.Seconds.per.Year)/this.Calendar.Seconds.per.Month);a.days=Math.floor((this.seconds-a.years*this.Calendar.Seconds.per.Year-a.months*this.Calendar.Seconds.per.Month)/this.Calendar.Seconds.per.Day);a.hours=Math.floor((this.seconds-a.years*this.Calendar.Seconds.per.Year-a.months*this.Calendar.Seconds.per.Month-a.days*this.Calendar.Seconds.per.Day)/
this.Calendar.Seconds.per.Hour);a.minutes=Math.floor((this.seconds-a.years*this.Calendar.Seconds.per.Year-a.months*this.Calendar.Seconds.per.Month-a.days*this.Calendar.Seconds.per.Day-a.hours*this.Calendar.Seconds.per.Hour)/this.Calendar.Seconds.per.Minute);a.seconds=Math.round(this.seconds-a.years*this.Calendar.Seconds.per.Year-a.months*this.Calendar.Seconds.per.Month-a.days*this.Calendar.Seconds.per.Day-a.hours*this.Calendar.Seconds.per.Hour-a.minutes*this.Calendar.Seconds.per.Minute);return a};
Duration.prototype.ago=function(){return 0==this.seconds?"just now":this.seconds<this.Calendar.Seconds.per.Minute?this.seconds+" second"+(1<this.seconds?"s":"")+" ago":this.seconds<this.Calendar.Seconds.per.Hour?Math.floor(this.inMinutes())+" minute"+(1<Math.floor(this.inMinutes())?"s":"")+" ago":this.seconds<this.Calendar.Seconds.per.Day?Math.floor(this.inHours())+" hour"+(1<Math.floor(this.inHours())?"s":"")+" ago":this.seconds<this.Calendar.Seconds.per.Week?Math.floor(this.inDays())+" day"+(1<
Math.floor(this.inDays())?"s":"")+" ago":this.seconds<this.Calendar.Seconds.per.Month?Math.floor(this.inWeeks())+" week"+(1<Math.floor(this.inWeeks())?"s":"")+" ago":this.seconds<this.Calendar.Seconds.per.Year?Math.floor(this.inMonths())+" month"+(1<Math.floor(this.inMonths())?"s":"")+" ago":Math.floor(this.inYears())+" year"+(1<Math.floor(this.inYears())?"s":"")+" ago"};
Duration.prototype.asClock=function(){var a=this.value();return 0==a.hours?a.minutes+":"+(10>a.seconds?"0"+a.seconds:a.seconds):a.hours+":"+(10>a.minutes?"0"+a.minutes:a.minutes)+":"+(10>a.seconds?"0"+a.seconds:a.seconds)};
Duration.prototype.asStandard=function(){var a=this.value();return 0==this.seconds?"PT0S":"P"+(0<a.years?a.years+"Y":"")+(0<a.months?a.months+"M":"")+(0<a.days?a.days+"D":"")+(0<a.hours||0<a.minutes||0<a.seconds?"T":"")+(0<a.hours?a.hours+"H":"")+(0<a.minutes?a.minutes+"M":"")+(0<a.seconds?a.seconds+"S":"")};Duration.prototype.asStandardWeeks=function(){return"P"+Math.floor(this.inWeeks())+"W"};
Duration.prototype.asExtended=function(){var a=this.value();return"P"+this.padInt(a.years,4)+"-"+this.padInt(a.months,2)+"-"+this.padInt(a.days,2)+"T"+this.padInt(a.hours,2)+":"+this.padInt(a.minutes,2)+":"+this.padInt(a.seconds,2)};Duration.prototype.asBasic=function(){var a=this.value();return"P"+this.padInt(a.years,4)+this.padInt(a.months,2)+this.padInt(a.days,2)+"T"+this.padInt(a.hours,2)+this.padInt(a.minutes,2)+this.padInt(a.seconds,2)};window.Duration=Duration;
