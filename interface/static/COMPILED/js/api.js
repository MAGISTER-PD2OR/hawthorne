// Generated by CoffeeScript 2.1.1
(function() {
  var group, server, submit;

  server = function(query, that = null) {
    $({
      'query': query
    }).ajax('/api/v1/servers', 'GET', function(data, status) {
      var ele, formatted, i, len;
      data = JSON.parse(data);
      data = data['result'];
      if (that !== null) {
        formatted = [
          {
            'value': 'all',
            'label': '<b>all</b>'
          }
        ];
        for (i = 0, len = data.length; i < len; i++) {
          ele = data[i];
          formatted.push({
            'value': ele.id,
            'label': ele.name
          });
        }
        that.setChoices(formatted, 'value', 'label', true);
      }
      return data;
    });
  };

  group = function(query, that = null) {
    $({
      'query': query
    }).ajax('/api/v1/roles', 'GET', function(data, status) {
      var ele, formatted, i, len;
      data = JSON.parse(data);
      data = data['result'];
      if (that !== null) {
        formatted = [];
        for (i = 0, len = data.length; i < len; i++) {
          ele = data[i];
          formatted.push({
            'value': ele.id,
            'label': ele.name
          });
        }
        that.setChoices(formatted, 'value', 'label', true);
      }
      return data;
    });
  };

  submit = function(mode = '', refresh = []) {
    var data, user;
    switch (mode) {
      case 'admin__administrator':
        data = {
          role: window.groupinput.getValue(true),
          promotion: true,
          force: true
        };
        user = window.usernameinput.getValue(true);
        window.endpoint.users[user].post(data, function(err, data) {
          if (data.success) {
            window.ajax.admin.admins(1);
          }
          return data;
        });
        return console.log(data);
      case 'admin__groups':
        return console.log('stoff');
      default:
        return console.log('stuff');
    }
  };

  window.api = {
    servers: server,
    groups: group,
    submit: submit
  };

}).call(this);
