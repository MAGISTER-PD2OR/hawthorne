// Generated by CoffeeScript 2.1.1
(function() {
  var search;

  search = function(query, that = null, internal = false) {
    var ts;
    ts = new Date().getTime();
    window.cache.steam = {
      _ts: ts
    };
    window.endpoint.api.steam.search[Number(internal)]({
      'query': query,
      '_ts': ts
    }).get(function(err, data) {
      var ele, formatted, i, len;
      data = data.result;
      if (data._ts < window.cache.steam._ts) {
        return false;
      }
      data = data.data;
      if (that !== null) {
        formatted = [];
        for (i = 0, len = data.length; i < len; i++) {
          ele = data[i];
          formatted.push({
            'value': ele.url,
            'label': `<img class='inner-dropdown-image' src='${ele.image}' />${ele.name}`
          });
        }
        that.setChoices(formatted, 'value', 'label', true);
      }
      return data;
    });
  };

  window.steam = {
    search: search
  };

}).call(this);
